<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>English Quantifiers Game</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@500;700&display=swap" rel="stylesheet">

<style>
  :root {
    --bg-color: #f1f8e9;
    --text-color: #4e342e;
    --card-bg: #ffffff;
    --accent-green: #558b2f;
    --accent-brown: #795548;
    --highlight-bg: #dcedc8;
    --main-font: "Zen Maru Gothic", sans-serif;
  }

  body {
    font-family: var(--main-font);
    background-color: var(--bg-color);
    color: var(--text-color);
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 5px; 
    margin: 0;
  }

  h2 { font-size: 1.5rem; margin: 5px 0; border-bottom: 3px dashed var(--accent-brown); }
  .sub-title { font-size: 0.8rem; color: var(--accent-green); margin-bottom: 5px; font-weight: bold; }

  .illustration-container {
    background-color: white; padding: 10px; border-radius: 15px; margin-bottom: 10px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1); text-align: center; 
    width: 98vw; max-width: 1100px; border: 3px solid var(--highlight-bg);
  }
  .img-pair { display: flex; justify-content: center; gap: 10px; }
  .illustration-large {
    width: 49%; height: auto; border-radius: 10px; border: 2px solid var(--accent-brown);
    max-height: 50vh; object-fit: contain;
  }

  .container {
    background: var(--card-bg); max-width: 900px; width: 100%; padding: 15px;
    border-radius: 20px; box-shadow: 0 6px 15px rgba(0,0,0,0.1); text-align: center;
    position: relative; border: 4px solid #fff; margin-bottom: 10px;
    display: flex; flex-direction: column;
  }

  /* ÁÆ°ÁêÜ„Éú„Çø„É≥ÔºöPC„ÅØÂè≥‰∏ä */
  .top-controls { position: absolute; top: 10px; right: 10px; display: flex; gap: 10px; }
  .header-btn {
    color: white; border: none; padding: 6px 15px; border-radius: 10px; cursor: pointer;
    font-weight: bold; background-color: var(--accent-brown); font-size: 0.8rem;
    box-shadow: 0 2px 0 rgba(0,0,0,0.2);
  }

  .question-box {
    font-size: 1.8rem; margin-bottom: 10px; min-height: 60px; 
    display: flex; align-items: center; justify-content: center;
    background-color: #fff8e1; border-radius: 15px; padding: 10px 20px; border: 3px solid #ffe0b2;
    font-weight: bold; line-height: 1.3;
  }

  .dialog-wrapper { text-align: left; width: 100%; }
  .dialog-line { margin-bottom: 4px; padding: 5px 15px; background: white; border-radius: 8px; border: 1px solid #efebe9; }
  .dialog-speaker { font-weight: bold; color: var(--accent-brown); margin-right: 8px; }

  .choices-grid { 
    display: flex; flex-direction: row; flex-wrap: nowrap;
    justify-content: space-between; gap: 8px; margin-bottom: 10px; width: 100%;
  }
  .choice-btn {
    background-color: white; border: 2px solid var(--accent-green); color: var(--text-color);
    padding: 12px 5px; border-radius: 12px; font-size: 1.3rem; cursor: pointer;
    font-weight: bold; flex: 1; box-shadow: 0 3px 0 var(--highlight-bg);
  }
  .choice-btn.selected { background-color: var(--accent-brown); color: white; border-color: var(--accent-brown); }
  .choice-btn.correct-choice { background-color: var(--accent-green) !important; color: white !important; border-color: var(--accent-green) !important; }
  .choice-btn.wrong-choice { background-color: #d32f2f !important; color: white !important; border-color: #b71c1c !important; }

  .controls { margin-top: 10px; }
  .action-btn {
    padding: 10px 50px; font-size: 1.4rem; background-color: var(--accent-green);
    color: white; border: none; border-radius: 30px; cursor: pointer;
    box-shadow: 0 4px 0 #33691e; font-weight: bold;
  }

  .result-msg { margin-bottom: 5px; font-weight: bold; font-size: 1.3rem; min-height: 30px; }
  .progress-container { width: 100%; background-color: #efebe9; border-radius: 10px; margin-bottom: 10px; height: 10px; overflow: hidden; }
  .progress-bar { height: 100%; background-color: var(--accent-green); width: 0%; transition: width 0.3s; }

  /* --- „Çπ„Éû„ÉõÁâàÔºöÈÖçÁΩÆË™øÊï¥ --- */
  @media (max-width: 600px) {
    .illustration-large { display: none; width: 100%; max-height: 25vh; }
    .illustration-large.active-mobile { display: block; }
    
    .container { padding: 10px; margin-bottom: 15px; }
    
    /* „Éó„É™„É≥„Éà/ÊúÄÂàù„Åã„Çâ„Éú„Çø„É≥„Çí„Äå‰∏ÄÁï™‰∏ã„Äç„Å∏ */
    .top-controls { 
      position: static; 
      margin-top: 20px; 
      justify-content: center;
      width: 100%;
    }
    .header-btn { padding: 10px 15px; font-size: 0.9rem; }

    .question-box { 
      font-size: 1.1rem; min-height: 60px; padding: 10px; 
      line-height: 1.4; display: block; white-space: normal; 
    }
    .choices-grid { flex-wrap: wrap; gap: 5px; }
    .choice-btn { font-size: 1rem; padding: 10px 5px; flex: 1 1 45%; }
    
    /* Check Answer„ÅØÈÅ∏ÊäûËÇ¢„ÅÆ„Åô„Åê‰∏ã */
    .controls { margin-top: 10px; }
    .action-btn { width: 90%; padding: 12px 0; }
  }

  #printable-sheet { display: none; }
  @media print {
    @page { size: A4; margin: 10mm 15mm; }
    body * { display: none !important; }
    #printable-sheet, #printable-sheet * { display: block !important; }
    #printable-sheet { position: absolute; left: 0; top: 0; width: 100%; background: white; color: black !important; font-family: "Zen Maru Gothic", sans-serif; }
    .sheet-header { text-align: center; border-bottom: 2px solid black; margin-bottom: 10px; padding-bottom: 5px; }
    .sheet-question { margin-bottom: 12px; page-break-inside: avoid; border-bottom: none; padding-bottom: 5px; }
    .q-text { font-size: 14pt; margin-bottom: 3px; line-height: 1.4; font-weight: bold; }
    .q-options-line { font-size: 11pt; margin-left: 20px; font-style: italic; color: black; }
    .answer-key { page-break-before: always; margin-top: 20px; border-top: 2px solid black; padding-top: 20px; }
    .answer-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 12pt; }
  }
</style>
</head>
<body>

<h2>Quantifiers Game</h2>
<div class="sub-title">„Ç§„É©„Çπ„Éà„ÇíË¶ã„Å¶Ê≠£„Åó„ÅÑË®ÄËëâ„ÇíÈÅ∏„Åº„ÅÜ</div>

<div class="illustration-container">
  <div class="img-pair">
    <img src="some-and-a-lot.jpg" id="img-a" class="illustration-large">
    <img src="money-water-books.jpg" id="img-b" class="illustration-large">
  </div>
</div>

<div class="container">
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>
  
  <div class="question-box" id="questionText">Loading...</div>
  <div class="choices-grid" id="choicesGrid"></div>
  <div class="result-msg" id="resultMsg"></div>
  
  <div class="controls">
    <button class="action-btn" id="checkBtn" onclick="checkAnswer()">Check Answer</button>
    <button class="action-btn" id="nextBtn" onclick="nextQuestion()" style="display:none; background-color: #ff9800;">Next Question ‚û°</button>
  </div>

  <div class="top-controls">
    <button class="header-btn" onclick="window.print()">üñ®Ô∏è „Éó„É™„É≥„Éà (PDF)</button>
    <button class="header-btn" onclick="initGame()">üîÑ ÊúÄÂàù„Åã„Çâ</button>
  </div>
</div>

<div id="printable-sheet">
  <div class="sheet-header">
    <h1 style="font-size: 18pt; margin: 0;">English Quantifiers Worksheet</h1>
    <div style="text-align:right; font-size:11pt;">Name: ____________________</div>
  </div>
  <div id="sheet-content"></div>
  <div class="answer-key">
    <h2 style="font-size: 16pt; margin-bottom: 10px;">Answer Key</h2>
    <div id="sheet-answers" class="answer-grid"></div>
  </div>
</div>

<script>
  const quizData = [
    { q: "1. You have („ÄÄ„ÄÄ) books.", options: ["a little", "a few", "a lot of", "only"], answer: "a lot of" },
    { q: "2. Look! There are so („ÄÄ„ÄÄ) hats!", options: ["some", "many", "a little", "about"], answer: "many" },
    { q: "3. Don't put too („ÄÄ„ÄÄ) sugar in your tea!", options: ["many", "much", "a few", "about"], answer: "much" },
    { q: "4. We are having so („ÄÄ„ÄÄ) fun today!", options: ["some", "much", "a few", "about"], answer: "much" },
    { q: "5. There are („ÄÄ„ÄÄ) 20 books on the shelf.", options: ["only", "some", "a few", "about"], answer: "about" },
    { isDialog: true, q: ["A: How many books do you have?", "B: („ÄÄ„ÄÄ) one!"], options: ["About", "Many", "Only", "Some"], answer: "Only" },
    { q: "7. I see („ÄÄ„ÄÄ) ten children. They are playing.", options: ["many", "some", "about", "a few"], answer: "about" },
    { q: "8. I have („ÄÄ„ÄÄ) water in my glass. I want more, please.", options: ["a little", "a lot of", "a few", "many"], answer: "a little" },
    { q: "9. I have („ÄÄ„ÄÄ) hats.", options: ["a little", "a few", "some", "about"], answer: "a few" },
    { q: "10. She is rich! She has so („ÄÄ„ÄÄ) money.", options: ["many", "much", "a few", "about"], answer: "much" },
    { q: "11. He drinks („ÄÄ„ÄÄ) water.", options: ["many", "a little", "a lot of", "a few"], answer: "a lot of" },
    { q: "12. He is carrying („ÄÄ„ÄÄ) books.", options: ["much", "a little", "some", "only"], answer: "some" }
  ];

  let currentIndex = 0;
  let selectedWord = "";
  let selectedBtn = null;
  let resetTimer = null; // „Ç¥„Éº„Çπ„ÉàÈÄÄÊ≤ªÁî®„Çø„Ç§„Éû„ÉºÁÆ°ÁêÜ

  function initGame() {
    currentIndex = 0;
    loadQuestion();
    generatePrintSheet();
  }

  function renderQuestionWithWord(word = "„ÄÄ„ÄÄ") {
    const qBox = document.getElementById('questionText');
    const q = quizData[currentIndex];
    const colorCode = "#2e7d32"; 
    
    if (q.isDialog) {
        let html = '<div class="dialog-wrapper">';
        q.q.forEach((line, i) => {
            const parts = line.split(':');
            let text = parts[1];
            if(i === 1) text = text.replace('(„ÄÄ„ÄÄ)', `( <span style="color:${colorCode}">${word}</span> )`);
            html += `<div class="dialog-line"><span class="dialog-speaker">${parts[0]}:</span>${text}</div>`;
        });
        html += '</div>';
        qBox.innerHTML = html;
    } else {
        qBox.innerHTML = q.q.replace('(„ÄÄ„ÄÄ)', `( <span style="color:${colorCode}">${word}</span> )`);
    }
  }

  function loadQuestion() {
    // „ÄêÈáçË¶Å„Äë„Ç¥„Éº„Çπ„ÉàÈÄÄÊ≤ªÔºöÂâç„ÅÆÂïèÈ°å„ÅÆ„É™„Çª„ÉÉ„Éà„Çø„Ç§„Éû„Éº„Åå„ÅÇ„Çå„Å∞ÂÅúÊ≠¢„Åô„Çã
    if (resetTimer) {
        clearTimeout(resetTimer);
        resetTimer = null;
    }

    selectedWord = "";
    selectedBtn = null;
    document.getElementById('resultMsg').textContent = "";
    document.getElementById('checkBtn').style.display = "inline-block";
    document.getElementById('nextBtn').style.display = "none";
    document.getElementById('progressBar').style.width = (currentIndex / quizData.length * 100) + "%";

    const imgA = document.getElementById('img-a');
    const imgB = document.getElementById('img-b');
    if (currentIndex < 9) { imgA.classList.add('active-mobile'); imgB.classList.remove('active-mobile'); }
    else { imgA.classList.remove('active-mobile'); imgB.classList.add('active-mobile'); }

    renderQuestionWithWord();

    const grid = document.getElementById('choicesGrid');
    grid.innerHTML = "";
    quizData[currentIndex].options.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = "choice-btn";
        btn.textContent = opt;
        btn.onclick = () => {
            if(document.getElementById('nextBtn').style.display === "inline-block") return;
            document.querySelectorAll('.choice-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            selectedWord = opt;
            selectedBtn = btn;
            renderQuestionWithWord(opt);
        };
        grid.appendChild(btn);
    });
  }

  function checkAnswer() {
    if(!selectedWord) return;
    const q = quizData[currentIndex];
    const isCorrect = (selectedWord === q.answer);
    const msg = document.getElementById('resultMsg');
    
    if(isCorrect) {
        selectedBtn.classList.add('correct-choice');
        document.querySelectorAll('.choice-btn').forEach(btn => btn.disabled = true);
        msg.textContent = "‚ú® Correct! ‚ú®";
        msg.className = "result-msg correct";
        document.getElementById('checkBtn').style.display = "none";
        document.getElementById('nextBtn').style.display = "inline-block";
    } else {
        selectedBtn.classList.add('wrong-choice');
        selectedBtn.classList.remove('selected');
        msg.textContent = "Try again!";
        msg.className = "result-msg wrong";
        selectedWord = "";
        
        // „Ç´„ÉÉ„Ç≥ÂÜÖ„Çí„É™„Çª„ÉÉ„Éà„Åô„Çã„Çø„Ç§„Éû„Éº„Çí„Çª„ÉÉ„ÉàÔºàÂ§âÊï∞„Å´‰øùÂ≠òÔºâ
        resetTimer = setTimeout(() => { 
            if(selectedWord === "") renderQuestionWithWord(); 
            resetTimer = null;
        }, 1200);
    }
  }

  function nextQuestion() {
    currentIndex++;
    if(currentIndex < quizData.length) loadQuestion();
    else {
        document.getElementById('questionText').innerHTML = "üéâ All Clear!";
        document.getElementById('choicesGrid').innerHTML = "";
        document.getElementById('nextBtn').style.display = "none";
        document.getElementById('progressBar').style.width = "100%";
    }
  }

  function generatePrintSheet() {
    const content = document.getElementById('sheet-content');
    const answers = document.getElementById('sheet-answers');
    content.innerHTML = ""; answers.innerHTML = "";
    const wideGap = "( „ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ„ÄÄ )";
    quizData.forEach((item, index) => {
      const qBlock = document.createElement('div');
      qBlock.className = 'sheet-question';
      let qTextForPrint = item.isDialog ? item.q.join(' / ') : item.q;
      qTextForPrint = qTextForPrint.replace('(„ÄÄ„ÄÄ)', wideGap);
      qBlock.innerHTML = `<div class="q-text">${qTextForPrint}</div><div class="q-options-line">[ ${item.options.join('  /  ')} ]</div>`;
      content.appendChild(qBlock);
      const aBlock = document.createElement('div');
      aBlock.innerHTML = `<b>Q${index+1}:</b> ${item.answer}`;
      answers.appendChild(aBlock);
    });
  }
  initGame();
</script>
</body>
</html>
